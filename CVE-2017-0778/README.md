stagefright -s CVE-2017-0778.mp4

01-31 00:15:09.718 11070 11071 I         : =================================================================
01-31 00:15:09.718 11070 11071 I         :
01-31 00:15:09.718 11070 11071 I         :
01-31 00:15:09.718 11070 11071 I         : ==11070==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xeb602ff5 at pc 0xed63bd48 bp 0xeb7feb90 sp 0xeb7feb88
01-31 00:15:09.718 11070 11071 I         :
01-31 00:15:09.719 11070 11071 I         :
01-31 00:15:09.719 11070 11071 I         : READ of size 1 at 0xeb602ff5 thread T1 (Binder:11070_1)
01-31 00:15:09.719 11070 11071 I         :
01-31 00:15:09.720 11079 11079 I Binder:11070_1: type=1400 audit(0.0:109): avc: denied { execute_no_trans } for path="/system/bin/llvm-symbolizer" dev="dm-0" ino=351 scontext=u:r:mediaextractor:s0 tcontext=u:object_r:system_file:s0 tclass=file permissive=1
01-31 00:15:09.852 11070 11071 I         :     #0 0xed63bd47 in android::U16_AT(unsigned char const*) /proc/self/cwd/frameworks/av/media/libstagefright/Utils.cpp:51:26
01-31 00:15:09.852 11070 11071 I         :
01-31 00:15:09.856 11070 11071 I         :     #1 0xed55b973 in android::MPEG4Extractor::parse3GPPMetaData(long long, unsigned int, int) /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:2985:29
01-31 00:15:09.856 11070 11071 I         :
01-31 00:15:09.857 11070 11071 I         :     #2 0xed54df3b in android::MPEG4Extractor::parseChunk(long long*, int) /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:2276:28
01-31 00:15:09.857 11070 11071 I         :
01-31 00:15:09.858 11070 11071 I         :     #3 0xed54a79f in android::MPEG4Extractor::readMetaData() /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:532:15
01-31 00:15:09.858 11070 11071 I         :
01-31 00:15:09.859 11070 11071 I         :     #4 0xed54a537 in android::MPEG4Extractor::getMetaData() /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:418:16
01-31 00:15:09.859 11070 11071 I         :
01-31 00:15:09.865 11070 11071 I         :     #5 0xed3a6cf7 in android::BnMediaExtractor::onTransact(unsigned int, android::Parcel const&, android::Parcel*, unsigned int) (/system/lib/libmedia.so+0x88cf7)
01-31 00:15:09.865 11070 11071 I         :
01-31 00:15:09.869 11070 11071 I         :     #6 0xedba59bf in android::BBinder::transact(unsigned int, android::Parcel const&, android::Parcel*, unsigned int) (/system/lib/libbinder.so+0x359bf)
01-31 00:15:09.869 11070 11071 I         :
01-31 00:15:09.869 11070 11071 I         :     #7 0xedbad19d in android::IPCThreadState::executeCommand(int) (/system/lib/libbinder.so+0x3d19d)
01-31 00:15:09.870 11070 11071 I         :
01-31 00:15:09.870 11070 11071 I         :     #8 0xedbacdf1 in android::IPCThreadState::getAndExecuteCommand() (/system/lib/libbinder.so+0x3cdf1)
01-31 00:15:09.870 11070 11071 I         :
01-31 00:15:09.870 11070 11071 I         :     #9 0xedbad301 in android::IPCThreadState::joinThreadPool(bool) (/system/lib/libbinder.so+0x3d301)
01-31 00:15:09.870 11070 11071 I         :
01-31 00:15:09.871 11070 11071 I         :     #10 0xedbbf977  (/system/lib/libbinder.so+0x4f977)
01-31 00:15:09.871 11070 11071 I         :
01-31 00:15:09.872 11070 11071 I         :     #11 0xed1a6325 in android::Thread::_threadLoop(void*) (/system/lib/libutils.so+0xe325)
01-31 00:15:09.872 11070 11071 I         :
01-31 00:15:09.877 11070 11071 I         :     #12 0xee279093 in __pthread_start(void*) (/system/lib/libc.so+0x47093)
01-31 00:15:09.877 11070 11071 I         :
01-31 00:15:09.878 11070 11071 I         :     #13 0xee24bbdd in __start_thread (/system/lib/libc.so+0x19bdd)
01-31 00:15:09.878 11070 11071 I         :
01-31 00:15:09.878 11070 11071 I         :
01-31 00:15:09.878 11070 11071 I         :
01-31 00:15:09.878 11070 11071 I         : 0xeb602ff5 is located 0 bytes to the right of 5-byte region [0xeb602ff0,0xeb602ff5)
01-31 00:15:09.878 11070 11071 I         :
01-31 00:15:09.878 11070 11071 I         : allocated by thread T1 (Binder:11070_1) here:
01-31 00:15:09.878 11070 11071 I         :
01-31 00:15:09.881 11070 11071 I         :     #0 0xedd1a22f in operator new[](unsigned int) (/system/lib/libclang_rt.asan-arm-android.so+0x8222f)
01-31 00:15:09.881 11070 11071 I         :
01-31 00:15:09.882 11070 11071 I         :     #1 0xed55b757 in android::MPEG4Extractor::parse3GPPMetaData(long long, unsigned int, int) /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:2936:23
01-31 00:15:09.882 11070 11071 I         :
01-31 00:15:09.883 11070 11071 I         :     #2 0xed54df3b in android::MPEG4Extractor::parseChunk(long long*, int) /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:2276:28
01-31 00:15:09.883 11070 11071 I         :
01-31 00:15:09.884 11070 11071 I         :     #3 0xed54a79f in android::MPEG4Extractor::readMetaData() /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:532:15
01-31 00:15:09.884 11070 11071 I         :
01-31 00:15:09.884 11070 11071 I         :     #4 0xed54a537 in android::MPEG4Extractor::getMetaData() /proc/self/cwd/frameworks/av/media/libstagefright/MPEG4Extractor.cpp:418:16
01-31 00:15:09.885 11070 11071 I         :
01-31 00:15:09.885 11070 11071 I         :     #5 0xed3a6cf7 in android::BnMediaExtractor::onTransact(unsigned int, android::Parcel const&, android::Parcel*, unsigned int) (/system/lib/libmedia.so+0x88cf7)
01-31 00:15:09.885 11070 11071 I         :
01-31 00:15:09.885 11070 11071 I         :
01-31 00:15:09.885 11070 11071 I         :
01-31 00:15:09.885 11070 11071 I         : Thread T1 (Binder:11070_1) created by T0 here:
01-31 00:15:09.885 11070 11071 I         :
01-31 00:15:09.886 11070 11071 I         :     #0 0xedcf44db in pthread_create (/system/lib/libclang_rt.asan-arm-android.so+0x5c4db)
01-31 00:15:09.886 11070 11071 I         :
01-31 00:15:09.886 11070 11071 I         :     #1 0xed1a5ed9 in androidCreateRawThreadEtc (/system/lib/libutils.so+0xded9)
01-31 00:15:09.886 11070 11071 I         :
01-31 00:15:09.886 11070 11071 I         :     #2 0xee248c61 in __libc_init (/system/lib/libc.so+0x16c61)
01-31 00:15:09.886 11070 11071 I         :
01-31 00:15:09.887 11070 11071 I         :     #3 0xffffffff  (<unknown module>)
01-31 00:15:09.887 11070 11071 I         :
01-31 00:15:09.887 11070 11071 I         :
01-31 00:15:09.887 11070 11071 I         :
01-31 00:15:09.888 11070 11071 I         : SUMMARY: AddressSanitizer: heap-buffer-overflow /proc/self/cwd/frameworks/av/media/libstagefright/Utils.cpp:51:26 in android::U16_AT(unsigned char const*)
01-31 00:15:09.888 11070 11071 I         :
01-31 00:15:09.889 11070 11071 I         : Shadow bytes around the buggy address:
01-31 00:15:09.889 11070 11071 I         :   0x1d6c05a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c05b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c05c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c05d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c05e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         : =>0x1d6c05f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa[05]fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c0600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c0610: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c0620: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c0630: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         :   0x1d6c0640: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-31 00:15:09.889 11070 11071 I         : Shadow byte legend (one shadow byte represents 8 application bytes):
01-31 00:15:09.889 11070 11071 I         :   Addressable:           00
01-31 00:15:09.889 11070 11071 I         :   Partially addressable: 01 02 03 04 05 06 07
01-31 00:15:09.889 11070 11071 I         :   Heap left redzone:       fa
01-31 00:15:09.889 11070 11071 I         :   Heap right redzone:      fb
01-31 00:15:09.889 11070 11071 I         :   Freed heap region:       fd
01-31 00:15:09.889 11070 11071 I         :   Stack left redzone:      f1
01-31 00:15:09.889 11070 11071 I         :   Stack mid redzone:       f2
01-31 00:15:09.889 11070 11071 I         :   Stack right redzone:     f3
01-31 00:15:09.889 11070 11071 I         :   Stack partial redzone:   f4
01-31 00:15:09.889 11070 11071 I         :   Stack after return:      f5
01-31 00:15:09.889 11070 11071 I         :   Stack use after scope:   f8
01-31 00:15:09.889 11070 11071 I         :   Global redzone:          f9
01-31 00:15:09.889 11070 11071 I         :   Global init order:       f6
01-31 00:15:09.889 11070 11071 I         :   Poisoned by user:        f7
01-31 00:15:09.889 11070 11071 I         :   Container overflow:      fc
01-31 00:15:09.889 11070 11071 I         :   Array cookie:            ac
01-31 00:15:09.889 11070 11071 I         :   Intra object redzone:    bb
01-31 00:15:09.889 11070 11071 I         :   ASan internal:           fe
01-31 00:15:09.889 11070 11071 I         :   Left alloca redzone:     ca
01-31 00:15:09.889 11070 11071 I         :   Right alloca redzone:    cb
01-31 00:15:09.889 11070 11071 I         :
01-31 00:15:09.890 11070 11071 I         : ==11070==ABORTING
