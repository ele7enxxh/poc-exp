stagefright -s CVE-2017-0719.mpeg2

06-08 23:09:16.837 12401 12420 I         : =================================================================
06-08 23:09:16.837 12401 12420 I         :
06-08 23:09:16.838 12401 12420 I         :
06-08 23:09:16.838 12401 12420 I         : ==12401==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xec706f28 at pc 0xf0eeadec bp 0xee5ff618 sp 0xee5ff1e4
06-08 23:09:16.838 12401 12420 I         :
06-08 23:09:16.839 12401 12420 I         :
06-08 23:09:16.839 12401 12420 I         : WRITE of size 8 at 0xec706f28 thread T12
06-08 23:09:16.839 12401 12420 I         :
06-08 23:09:16.964 12401 12420 I         :     #0 0xf0eeadeb in __asan_memcpy (/system/lib/libclang_rt.asan-arm-android.so+0x5cdeb)
06-08 23:09:16.965 12401 12420 I         :
06-08 23:09:16.974 12401 12420 I         :     #1 0xef76b0cb in impeg2d_mc_fullx_fully /proc/self/cwd/external/libmpeg2/decoder/impeg2d_mc.c:1263:13
06-08 23:09:16.974 12401 12420 I         :
06-08 23:09:16.975 12401 12420 I         :     #2 0xef7609a3 in impeg2d_motion_comp_recon_buf /proc/self/cwd/external/libmpeg2/decoder/impeg2d_mc.c:190:5
06-08 23:09:16.975 12401 12420 I         :
06-08 23:09:16.975 12401 12420 I         :     #3 0xef7609a3 in impeg2d_mc_fw_or_bk_mb /proc/self/cwd/external/libmpeg2/decoder/impeg2d_mc.c:262
06-08 23:09:16.975 12401 12420 I         :
06-08 23:09:16.976 12401 12420 I         :     #4 0xef7484bb in impeg2d_dec_p_b_slice /proc/self/cwd/external/libmpeg2/decoder/impeg2d_pnb_pic.c:535:13
06-08 23:09:16.976 12401 12420 I         :
06-08 23:09:16.976 12401 12420 I         :     #5 0xef7580d7 in impeg2d_dec_slice /proc/self/cwd/external/libmpeg2/decoder/impeg2d_dec_hdr.c:843:15
06-08 23:09:16.977 12401 12420 I         :
06-08 23:09:16.977 12401 12420 I         :     #6 0xef75867f in impeg2d_dec_pic_data_thread /proc/self/cwd/external/libmpeg2/decoder/impeg2d_dec_hdr.c:933:23
06-08 23:09:16.977 12401 12420 I         :
06-08 23:09:16.983 12401 12420 I         :     #7 0xf0cb9093 in __pthread_start(void*) (/system/lib/libc.so+0x47093)
06-08 23:09:16.983 12401 12420 I         :
06-08 23:09:16.983 12401 12420 I         :     #8 0xf0c8bbdd in __start_thread (/system/lib/libc.so+0x19bdd)
06-08 23:09:16.983 12401 12420 I         :
06-08 23:09:16.983 12401 12420 I         :
06-08 23:09:16.983 12401 12420 I         :
06-08 23:09:16.983 12401 12420 I         : 0xec706f28 is located 40 bytes to the right of 13824-byte region [0xec703900,0xec706f00)
06-08 23:09:16.983 12401 12420 I         :
06-08 23:09:16.984 12401 12420 I         : allocated by thread T0 here:
06-08 23:09:16.984 12401 12420 I         :
06-08 23:09:16.984 12401 12420 I         :     #0 0xf0f031ef in memalign (/system/lib/libclang_rt.asan-arm-android.so+0x751ef)
06-08 23:09:16.984 12401 12420 I         :
06-08 23:09:16.985 12401 12420 I         :     #1 0xef72930b in android::SoftMPEG2::initDecoder() /proc/self/cwd/frameworks/av/media/libstagefright/codecs/mpeg2dec/SoftMPEG2.cpp:340:35
06-08 23:09:16.985 12401 12420 I         :
06-08 23:09:16.986 12401 12420 I         :     #2 0xef72bf2f in android::SoftMPEG2::reInitDecoder() /proc/self/cwd/frameworks/av/media/libstagefright/codecs/mpeg2dec/SoftMPEG2.cpp:445:11
06-08 23:09:16.986 12401 12420 I         :
06-08 23:09:16.986 12401 12420 I         :     #3 0xef72c747 in android::SoftMPEG2::internalSetParameter(OMX_INDEXTYPE, void*) /proc/self/cwd/frameworks/av/media/libstagefright/codecs/mpeg2dec/SoftMPEG2.cpp:509:9
06-08 23:09:16.986 12401 12420 I         :
06-08 23:09:16.988 12401 12420 I         :     #4 0xf0bc1543 in android::SimpleSoftOMXComponent::setParameter(OMX_INDEXTYPE, void*) (/system/lib/libstagefright_omx.so+0x22543)
06-08 23:09:16.988 12401 12420 I         :
06-08 23:09:16.988 12401 12420 I         :
06-08 23:09:16.988 12401 12420 I         :
06-08 23:09:16.988 12401 12420 I         : Thread T12 created by T2 (e.mpeg2.decoder) here:
06-08 23:09:16.988 12401 12420 I         :
06-08 23:09:16.989 12401 12420 I         :     #0 0xf0eea4db in pthread_create (/system/lib/libclang_rt.asan-arm-android.so+0x5c4db)
06-08 23:09:16.989 12401 12420 I         :
06-08 23:09:16.989 12401 12420 I         :     #1 0xef75b31f in impeg2d_dec_pic_data /proc/self/cwd/external/libmpeg2/decoder/impeg2d_dec_hdr.c:1349:13
06-08 23:09:16.989 12401 12420 I         :
06-08 23:09:16.989 12401 12420 I         :     #2 0xef75d57b in impeg2d_process_video_bit_stream /proc/self/cwd/external/libmpeg2/decoder/impeg2d_dec_hdr.c:1720:17
06-08 23:09:16.989 12401 12420 I         :
06-08 23:09:16.989 12401 12420 I         :     #3 0xef74336f in impeg2d_dec_frm /proc/self/cwd/external/libmpeg2/decoder/impeg2d_decoder.c:198:19
06-08 23:09:16.990 12401 12420 I         :
06-08 23:09:16.991 12401 12420 I         :     #4 0xef740463 in impeg2d_api_entity /proc/self/cwd/external/libmpeg2/decoder/impeg2d_api_main.c:3379:17
06-08 23:09:16.991 12401 12420 I         :
06-08 23:09:16.991 12401 12420 I         :     #5 0xef72df33 in android::SoftMPEG2::onQueueFilled(unsigned int) /proc/self/cwd/frameworks/av/media/libstagefright/codecs/mpeg2dec/SoftMPEG2.cpp:689:22
06-08 23:09:16.991 12401 12420 I         :
06-08 23:09:16.992 12401 12420 I         :     #6 0xf0bc2009 in android::SimpleSoftOMXComponent::onMessageReceived(android::sp<android::AMessage> const&) (/system/lib/libstagefright_omx.so+0x23009)
06-08 23:09:16.992 12401 12420 I         :
06-08 23:09:16.992 12401 12420 I         :
06-08 23:09:16.992 12401 12420 I         :
06-08 23:09:16.992 12401 12420 I         : Thread T2 (e.mpeg2.decoder) created by T1 (Binder:12401_1) here:
06-08 23:09:16.992 12401 12420 I         :
06-08 23:09:16.992 12401 12420 I         :     #0 0xf0eea4db in pthread_create (/system/lib/libclang_rt.asan-arm-android.so+0x5c4db)
06-08 23:09:16.992 12401 12420 I         :
06-08 23:09:16.993 12401 12420 I         :     #1 0xf1475ed9 in androidCreateRawThreadEtc (/system/lib/libutils.so+0xded9)
06-08 23:09:16.993 12401 12420 I         :
06-08 23:09:16.994 12401 12420 I         :     #2 0xef73094f in createSoftOMXComponent(char const*, OMX_CALLBACKTYPE const*, void*, OMX_COMPONENTTYPE**) /proc/self/cwd/frameworks/av/media/libstagefright/codecs/mpeg2dec/SoftMPEG2.cpp:845:16
06-08 23:09:16.994 12401 12420 I         :
06-08 23:09:16.994 12401 12420 I         :     #3 0xf0bc335d in android::SoftOMXPlugin::makeComponentInstance(char const*, OMX_CALLBACKTYPE const*, void*, OMX_COMPONENTTYPE**) (/system/lib/libstagefright_omx.so+0x2435d)
06-08 23:09:16.994 12401 12420 I         :
06-08 23:09:16.994 12401 12420 I         :
06-08 23:09:16.994 12401 12420 I         :
06-08 23:09:16.995 12401 12420 I         : Thread T1 (Binder:12401_1) created by T0 here:
06-08 23:09:16.995 12401 12420 I         :
06-08 23:09:16.995 12401 12420 I         :     #0 0xf0eea4db in pthread_create (/system/lib/libclang_rt.asan-arm-android.so+0x5c4db)
06-08 23:09:16.995 12401 12420 I         :
06-08 23:09:16.995 12401 12420 I         :     #1 0xf1475ed9 in androidCreateRawThreadEtc (/system/lib/libutils.so+0xded9)
06-08 23:09:16.995 12401 12420 I         :
06-08 23:09:16.995 12401 12420 I         :     #2 0xf0c88c61 in __libc_init (/system/lib/libc.so+0x16c61)
06-08 23:09:16.995 12401 12420 I         :
06-08 23:09:16.996 12401 12420 I         :     #3 0xffffffff  (<unknown module>)
06-08 23:09:16.996 12401 12420 I         :
06-08 23:09:16.996 12401 12420 I         :
06-08 23:09:16.996 12401 12420 I         :
06-08 23:09:16.996 12401 12420 I         : SUMMARY: AddressSanitizer: heap-buffer-overflow (/system/lib/libclang_rt.asan-arm-android.so+0x5cdeb) in __asan_memcpy
06-08 23:09:16.996 12401 12420 I         :
06-08 23:09:16.997 12401 12420 I         : Shadow bytes around the buggy address:
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0d90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0da0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0db0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0dc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0dd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
06-08 23:09:16.997 12401 12420 I         : =>0x1d8e0de0: fa fa fa fa fa[fa]fa fa fa fa fa fa fa fa fa fa
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0e20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
06-08 23:09:16.997 12401 12420 I         :   0x1d8e0e30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
06-08 23:09:16.997 12401 12420 I         : Shadow byte legend (one shadow byte represents 8 application bytes):
06-08 23:09:16.997 12401 12420 I         :   Addressable:           00
06-08 23:09:16.997 12401 12420 I         :   Partially addressable: 01 02 03 04 05 06 07
06-08 23:09:16.997 12401 12420 I         :   Heap left redzone:       fa
06-08 23:09:16.997 12401 12420 I         :   Heap right redzone:      fb
06-08 23:09:16.997 12401 12420 I         :   Freed heap region:       fd
06-08 23:09:16.997 12401 12420 I         :   Stack left redzone:      f1
06-08 23:09:16.997 12401 12420 I         :   Stack mid redzone:       f2
06-08 23:09:16.997 12401 12420 I         :   Stack right redzone:     f3
06-08 23:09:16.997 12401 12420 I         :   Stack partial redzone:   f4
06-08 23:09:16.997 12401 12420 I         :   Stack after return:      f5
06-08 23:09:16.997 12401 12420 I         :   Stack use after scope:   f8
06-08 23:09:16.997 12401 12420 I         :   Global redzone:          f9
06-08 23:09:16.997 12401 12420 I         :   Global init order:       f6
06-08 23:09:16.997 12401 12420 I         :   Poisoned by user:        f7
06-08 23:09:16.997 12401 12420 I         :   Container overflow:      fc
06-08 23:09:16.997 12401 12420 I         :   Array cookie:            ac
06-08 23:09:16.997 12401 12420 I         :   Intra object redzone:    bb
06-08 23:09:16.997 12401 12420 I         :   ASan internal:           fe
06-08 23:09:16.997 12401 12420 I         :   Left alloca redzone:     ca
06-08 23:09:16.997 12401 12420 I         :   Right alloca redzone:    cb
06-08 23:09:16.997 12401 12420 I         :
06-08 23:09:16.998 12401 12420 I         : ==12401==ABORTING 