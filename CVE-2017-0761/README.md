stagefright -s CVE-2017-0761.avc

01-23 11:26:51.976  4914  5112 I         : =================================================================
01-23 11:26:51.976  4914  5112 I         :
01-23 11:26:51.977  4914  5112 I         :
01-23 11:26:51.977  4914  5112 I         : ==4914==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xe7911a00 at pc 0xed59ddec bp 0xeacfeaf8 sp 0xeacfe6c4
01-23 11:26:51.977  4914  5112 I         :
01-23 11:26:51.977  4914  5112 I         :
01-23 11:26:51.977  4914  5112 I         : WRITE of size 88 at 0xe7911a00 thread T135 (le.h264.decoder)
01-23 11:26:51.977  4914  5112 I         :
01-23 11:26:52.024  4914  5112 I         :     #0 0xed59ddeb in __asan_memcpy (/system/lib/libclang_rt.asan-arm-android.so+0x5cdeb)
01-23 11:26:52.024  4914  5112 I         :
01-23 11:26:52.037  4914  5112 I         :     #1 0xeae95bf7 in ih264d_insert_pic_in_ref_pic_listx /proc/self/cwd/external/libavc/decoder/ih264d_process_pslice.c:67:26
01-23 11:26:52.037  4914  5112 I         :
01-23 11:26:52.037  4914  5112 I         :     #2 0xeae95bf7 in ih264d_init_ref_idx_lx_p /proc/self/cwd/external/libavc/decoder/ih264d_process_pslice.c:1076
01-23 11:26:52.037  4914  5112 I         :
01-23 11:26:52.038  4914  5112 I         :     #3 0xeae5602f in ih264d_parse_pslice /proc/self/cwd/external/libavc/decoder/ih264d_parse_pslice.c:1984:17
01-23 11:26:52.038  4914  5112 I         :
01-23 11:26:52.039  4914  5112 I         :     #4 0xeae9de7b in ih264d_parse_decode_slice /proc/self/cwd/external/libavc/decoder/ih264d_parse_slice.c:1831:15
01-23 11:26:52.039  4914  5112 I         :
01-23 11:26:52.040  4914  5112 I         :     #5 0xeae20e3f in ih264d_video_decode /proc/self/cwd/external/libavc/decoder/ih264d_api.c:2087:15
01-23 11:26:52.040  4914  5112 I         :
01-23 11:26:52.041  4914  5112 I         :     #6 0xeae2a583 in ih264d_api_function /proc/self/cwd/external/libavc/decoder/ih264d_api.c:3704:26
01-23 11:26:52.041  4914  5112 I         :
01-23 11:26:52.043  4914  5112 I         :     #7 0xeae177df in android::SoftAVC::onQueueFilled(unsigned int) /proc/self/cwd/frameworks/av/media/libstagefright/codecs/avcdec/SoftAVCDec.cpp:629:22
01-23 11:26:52.043  4914  5112 I         :
01-23 11:26:52.045  4914  5112 I         :     #8 0xedaec009 in android::SimpleSoftOMXComponent::onMessageReceived(android::sp<android::AMessage> const&) (/system/lib/libstagefright_omx.so+0x23009)
01-23 11:26:52.045  4914  5112 I         :
01-23 11:26:52.045  4914  5112 I         :     #9 0xedaed045  (/system/lib/libstagefright_omx.so+0x24045)
01-23 11:26:52.045  4914  5112 I         :
01-23 11:26:52.047  4914  5112 I         :     #10 0xed2d0455 in android::AHandler::deliverMessage(android::sp<android::AMessage> const&) (/system/lib/libstagefright_foundation.so+0xf455)
01-23 11:26:52.047  4914  5112 I         :
01-23 11:26:52.047  4914  5112 I         :     #11 0xed2d26ed in android::AMessage::deliver() (/system/lib/libstagefright_foundation.so+0x116ed)
01-23 11:26:52.047  4914  5112 I         :
01-23 11:26:52.047  4914  5112 I         :     #12 0xed2d0fc7 in android::ALooper::loop() (/system/lib/libstagefright_foundation.so+0xffc7)
01-23 11:26:52.047  4914  5112 I         :
01-23 11:26:52.049  4914  5112 I         :     #13 0xed0553a3 in android::Thread::_threadLoop(void*) (/system/lib/libutils.so+0xe3a3)
01-23 11:26:52.049  4914  5112 I         :
01-23 11:26:52.054  4914  5112 I         :     #14 0xed26a093 in __pthread_start(void*) (/system/lib/libc.so+0x47093)
01-23 11:26:52.054  4914  5112 I         :
01-23 11:26:52.055  4914  5112 I         :     #15 0xed23cbdd in __start_thread (/system/lib/libc.so+0x19bdd)
01-23 11:26:52.055  4914  5112 I         :
01-23 11:26:52.055  4914  5112 I         :
01-23 11:26:52.055  4914  5112 I         :
01-23 11:26:52.055  4914  5112 I         : 0xe7911a00 is located 0 bytes to the right of 22528-byte region [0xe790c200,0xe7911a00)
01-23 11:26:52.055  4914  5112 I         :
01-23 11:26:52.055  4914  5112 I         : allocated by thread T135 (le.h264.decoder) here:
01-23 11:26:52.055  4914  5112 I         :
01-23 11:26:52.056  4914  5112 I         :     #0 0xed5b61ef in memalign (/system/lib/libclang_rt.asan-arm-android.so+0x751ef)
01-23 11:26:52.056  4914  5112 I         :
01-23 11:26:52.056  4914  5112 I         :     #1 0xeae1ed77 in ih264d_allocate_static_bufs /proc/self/cwd/external/libavc/decoder/ih264d_api.c:1402:14
01-23 11:26:52.056  4914  5112 I         :
01-23 11:26:52.057  4914  5112 I         :     #2 0xeae2a12f in ih264d_create /proc/self/cwd/external/libavc/decoder/ih264d_api.c:1503:11
01-23 11:26:52.057  4914  5112 I         :
01-23 11:26:52.057  4914  5112 I         :     #3 0xeae2a12f in ih264d_api_function /proc/self/cwd/external/libavc/decoder/ih264d_api.c:3695
01-23 11:26:52.057  4914  5112 I         :
01-23 11:26:52.057  4914  5112 I         :     #4 0xeae14bf3 in android::SoftAVC::initDecoder() /proc/self/cwd/frameworks/av/media/libstagefright/codecs/avcdec/SoftAVCDec.cpp:319:18
01-23 11:26:52.057  4914  5112 I         :
01-23 11:26:52.058  4914  5112 I         :     #5 0xeae16b33 in android::SoftAVC::onQueueFilled(unsigned int) /proc/self/cwd/frameworks/av/media/libstagefright/codecs/avcdec/SoftAVCDec.cpp:527:19
01-23 11:26:52.058  4914  5112 I         :
01-23 11:26:52.058  4914  5112 I         :     #6 0xedaec009 in android::SimpleSoftOMXComponent::onMessageReceived(android::sp<android::AMessage> const&) (/system/lib/libstagefright_omx.so+0x23009)
01-23 11:26:52.059  4914  5112 I         :
01-23 11:26:52.059  4914  5112 I         :
01-23 11:26:52.059  4914  5112 I         :
01-23 11:26:52.059  4914  5112 I         : Thread T135 (le.h264.decoder) created by T4 (Binder:4914_2) here:
01-23 11:26:52.059  4914  5112 I         :
01-23 11:26:52.059  4914  5112 I         :     #0 0xed59d4db in pthread_create (/system/lib/libclang_rt.asan-arm-android.so+0x5c4db)
01-23 11:26:52.059  4914  5112 I         :
01-23 11:26:52.060  4914  5112 I         :     #1 0xed054ed9 in androidCreateRawThreadEtc (/system/lib/libutils.so+0xded9)
01-23 11:26:52.060  4914  5112 I         :
01-23 11:26:52.060  4914  5112 I         :     #2 0xedaed35d in android::SoftOMXPlugin::makeComponentInstance(char const*, OMX_CALLBACKTYPE const*, void*, OMX_COMPONENTTYPE**) (/system/lib/libstagefright_omx.so+0x2435d)
01-23 11:26:52.060  4914  5112 I         :
01-23 11:26:52.060  4914  5112 I         :
01-23 11:26:52.060  4914  5112 I         :
01-23 11:26:52.061  4914  5112 I         : Thread T4 (Binder:4914_2) created by T0 here:
01-23 11:26:52.061  4914  5112 I         :
01-23 11:26:52.061  4914  5112 I         :     #0 0xed59d4db in pthread_create (/system/lib/libclang_rt.asan-arm-android.so+0x5c4db)
01-23 11:26:52.061  4914  5112 I         :
01-23 11:26:52.061  4914  5112 I         :     #1 0xed054ed9 in androidCreateRawThreadEtc (/system/lib/libutils.so+0xded9)
01-23 11:26:52.061  4914  5112 I         :
01-23 11:26:52.061  4914  5112 I         :     #2 0xed239c61 in __libc_init (/system/lib/libc.so+0x16c61)
01-23 11:26:52.062  4914  5112 I         :
01-23 11:26:52.063  4914  5112 I         :     #3 0xffffffff  (<unknown module>)
01-23 11:26:52.063  4914  5112 I         :
01-23 11:26:52.063  4914  5112 I         :
01-23 11:26:52.063  4914  5112 I         :
01-23 11:26:52.063  4914  5112 I         : SUMMARY: AddressSanitizer: heap-buffer-overflow (/system/lib/libclang_rt.asan-arm-android.so+0x5cdeb) in __asan_memcpy
01-23 11:26:52.063  4914  5112 I         :
01-23 11:26:52.064  4914  5112 I         : Shadow bytes around the buggy address:
01-23 11:26:52.064  4914  5112 I         :   0x1cf222f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
01-23 11:26:52.064  4914  5112 I         :   0x1cf22300: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
01-23 11:26:52.064  4914  5112 I         :   0x1cf22310: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
01-23 11:26:52.064  4914  5112 I         :   0x1cf22320: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
01-23 11:26:52.064  4914  5112 I         :   0x1cf22330: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
01-23 11:26:52.064  4914  5112 I         : =>0x1cf22340:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-23 11:26:52.064  4914  5112 I         :   0x1cf22350: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-23 11:26:52.064  4914  5112 I         :   0x1cf22360: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-23 11:26:52.064  4914  5112 I         :   0x1cf22370: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-23 11:26:52.064  4914  5112 I         :   0x1cf22380: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-23 11:26:52.064  4914  5112 I         :   0x1cf22390: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
01-23 11:26:52.064  4914  5112 I         : Shadow byte legend (one shadow byte represents 8 application bytes):
01-23 11:26:52.064  4914  5112 I         :   Addressable:           00
01-23 11:26:52.064  4914  5112 I         :   Partially addressable: 01 02 03 04 05 06 07
01-23 11:26:52.064  4914  5112 I         :   Heap left redzone:       fa
01-23 11:26:52.064  4914  5112 I         :   Heap right redzone:      fb
01-23 11:26:52.064  4914  5112 I         :   Freed heap region:       fd
01-23 11:26:52.064  4914  5112 I         :   Stack left redzone:      f1
01-23 11:26:52.064  4914  5112 I         :   Stack mid redzone:       f2
01-23 11:26:52.064  4914  5112 I         :   Stack right redzone:     f3
01-23 11:26:52.064  4914  5112 I         :   Stack partial redzone:   f4
01-23 11:26:52.064  4914  5112 I         :   Stack after return:      f5
01-23 11:26:52.064  4914  5112 I         :   Stack use after scope:   f8
01-23 11:26:52.064  4914  5112 I         :   Global redzone:          f9
01-23 11:26:52.064  4914  5112 I         :   Global init order:       f6
01-23 11:26:52.064  4914  5112 I         :   Poisoned by user:        f7
01-23 11:26:52.064  4914  5112 I         :   Container overflow:      fc
01-23 11:26:52.064  4914  5112 I         :   Array cookie:            ac
01-23 11:26:52.064  4914  5112 I         :   Intra object redzone:    bb
01-23 11:26:52.064  4914  5112 I         :   ASan internal:           fe
01-23 11:26:52.064  4914  5112 I         :   Left alloca redzone:     ca
01-23 11:26:52.064  4914  5112 I         :   Right alloca redzone:    cb
01-23 11:26:52.064  4914  5112 I         :
01-23 11:26:52.065  4914  5112 I         : ==4914==ABORTING